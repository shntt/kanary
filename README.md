# Kanary
**日本語** | [English](./README_EN.md)

<div align="center">
  
  <p>左右の Command キーで IME を切り替える macOS ユーティリティ</p>
  <img src="Docs/Kanary_screenshot.png" alt="Kanary Icon" width="700">
</div>

---

## 概要

**Kanary** は、**左 Command キー**・**右 Command キー** の“単押し”により、日本語（かな）・英数入力を素早く切り替えられる macOS 向けユーティリティです。  
「Command + C などのショートカット」はそのまま通常通り動作させ、**単純にキーを押すだけで IME を切り替える**仕組みを提供します。

> **注意**: 現在のバージョンは **USキーボード配列** のみを正式サポートしています。UK配列などその他のキーボードレイアウトでは、動作が不安定になる可能性があります（後述「今後の計画」をご参照ください）。

---

## 特徴

1. **左右 Command キーで簡単に IME 切り替え**  
   - **左 Command** → 英数入力  
   - **右 Command** → かな入力  
   - **0.3秒以上の長押し**、または **他キーと組み合わせ**る場合は切り替え無効化 → 通常ショートカットを優先。

2. **システム拡張不要・軽量設計**  
   - アクセシビリティ許可のみで動作。  
   - macOS での作業を妨げず、シンプルに常駐。

3. **有効/無効の素早い切り替え**  
   - メニューバー常駐アイコンからワンクリックで ON/OFF。  
   - アプリごとの有効/無効設定も可能。

4. **アップデートチェック & 自動ダウンロード**  
   - GitHub Releases を定期的にチェックし、新バージョンがあれば通知。  
   - dmgファイルのダウンロード＆マウントもアプリ内から実行。

---

## 動作環境

- **対応OS**: macOS 13.5 以降  
  - 例: macOS Ventura 13.5, macOS Sonoma 14.0 など。  
- **CPU**: Apple Silicon / Intel Mac  
- **キーボード配列**: USキーボード（現時点の正式対応）  
- **権限**: アクセシビリティ許可が必要  
  - システム設定「プライバシーとセキュリティ > アクセシビリティ」で Kanary にチェックを入れてください。

> **今後の対応予定**  
> - 以前のバージョンの macOS（12.x / 11.x 等）  
> - UK配列など、その他のキーボードレイアウト

---

## インストール方法

1. [Releases](https://github.com/shntt/kanary/releases) から最新の `Kanary.dmg` をダウンロードします。  
2. `Kanary.dmg` を開き、中の `Kanary.app` を**アプリケーションフォルダ**へドラッグ＆ドロップします。  
3. 初回起動時、macOSの「アクセシビリティ許可」を求めるダイアログが表示されます。画面の指示に従って Kanary に権限を与えてください。  
4. メニューバーに Command アイコンが表示されればインストール完了です。

### アンインストール方法

1. アプリケーションフォルダから `Kanary.app` を削除します。  
2. 必要に応じて以下のファイル・フォルダを削除してください:
   ```
   ~/Library/Preferences/com.shntt.kanary.plist
   ~/Library/Caches/com.shntt.kanary/
   ```
3. 自動起動（Launch at Login）を設定していた場合、削除により無効化されます。

---

## 使い方

1. メニューバーの Command アイコンをクリックし、**「有効」** にします。  
2. キーボードの **左 Command キー** を単押しすると **英数入力** に切り替わります。  
3. キーボードの **右 Command キー** を単押しすると **かな入力** に切り替わります。  
4. **0.3秒以上押し続ける（長押し）**、または **他の修飾キー（Shift, Option, Controlなど）を同時に押す** ときは切り替えは行われません。ショートカット操作は通常の macOS と同じく動作します。  

### アプリ別の有効/無効設定

- 「環境設定 > アプリケーション」タブから、特定アプリを除外（オフ）にできます。  
- 例: “ゲームプレイ中は IME 切り替えが不要” など、柔軟に切り替えが可能です。

---

## 今後の計画

Kanary は現在 **USキーボード配列** 対応が中心ですが、以下のアップデートを検討しています。

1. **他のキーボードレイアウトへの対応**  
   - UK配列 / JIS配列などにおいても、同様に左右 Command キーで IME を切り替えられる機能を実装予定。

2. **他のキーへの割り当て**  
   - Command キー以外（例: Caps Lock, Option など）に変更したいという要望を取り入れ、キー設定のカスタマイズを実装。

3. **古い macOS バージョンへの対応**  
   - 現在 macOS 13.5 以降が要件ですが、要望があれば 12.x (Monterey) などへのバックポートを検討。

4. **追加のカスタマイズ機能**  
   - 長押し判定（0.3秒）のカスタマイズや、IME切り替え時のサウンド・通知を行う設定などの拡張。

これ以外にも改善・要望があれば、[Issues](https://github.com/shntt/kanary/issues) にてお知らせください。

---

## ビルド方法（開発者向け）

1. このリポジトリをクローン:
   ```bash
   git clone https://github.com/shntt/kanary.git
   cd kanary
   ```
2. [Xcode (15.0 以上)](https://developer.apple.com/xcode/) で `Kanary.xcodeproj` を開きます。  
3. そのまま **⌘+R** でビルド＆実行すると、アプリが起動しメニューバーへ常駐します。

> **メモ**: macOS 実機で動作をテストする際、アクセシビリティ許可の設定が必要になります。

---

## ライセンス

このソフトウェアは [MIT License](./LICENSE) のもとで公開しています。詳細は [LICENSE ファイル](./LICENSE) を参照してください。

---

## 開発への参加

ご意見・バグ報告・機能要望などは、[Issues](https://github.com/shntt/kanary/issues) や [Pull Requests](https://github.com/shntt/kanary/pulls) からお気軽にどうぞ。

1. 開発用ブランチを作成 (例: `feature/uk-keyboard-support`)  
2. コード修正 or 機能追加  
3. テストを実行後、Pull Request を作成して提案してください

[CONTRIBUTING.md](./CONTRIBUTING.md) もあわせてご参考ください。

---

## 謝辞

- 本ツールは、macOS 上での IME 切り替えを快適にするため、複数のオープンソースアイデアを参考に開発しました。  
- 特に**英かな**にインスパイアされており、その他、学習リソース・コミュニティに感謝します。
